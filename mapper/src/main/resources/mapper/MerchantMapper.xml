<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ligg.mapper.MerchantMapper">

    <!--  卡商金额结算 -->
    <update id="amountSettlement">
        update merchant
        set money = money + #{remainingAmount}
        where user_id = #{userId}
    </update>

    <!--  卡商提现 -->
    <update id="payouts">
        update merchant
        set money = money - #{balance}
        where user_id = #{userId}
    </update>

    <!--根据手机号查询卡商信息 -->
    <select id="selectByPhoneGetAdminUser" resultType="com.ligg.common.entity.admin.MerchantEntity">
        select au.user_id,
               au.money,
               au.nick_name,
               au.user_avatar,
               au.phone_number
        from orders uo
                 left join phone p on uo.phone_number = p.phone_number
                 left join merchant au on p.admin_user_id = au.user_id
        where uo.phone_number = #{phoneNumber}
    </select>
</mapper>